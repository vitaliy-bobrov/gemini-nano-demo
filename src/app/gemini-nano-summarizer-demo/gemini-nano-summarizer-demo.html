<gmd-ai-api-info
  [name]="summarizerAPIInfo.name"
  [availability]="summarizerAPIInfo.availability()"
  [downloadProgress]="summarizerAPIInfo.downloadProgress()"
  [error]="summarizerAPIInfo.error()"
  [docsLinks]="summarizerAPIInfo.docsLinks"
  [chromeInternalLinks]="summarizerAPIInfo.chromeInternalLinks"
  (download)="downloadSummarizerModel()"
/>

<section class="bug-report-section">
  <h2 class="mdc-typography--headline-medium">Technical Support Tickets</h2>

  <form class="options-form">
    <mat-form-field>
      <mat-label>Format</mat-label>
      <mat-select [(ngModel)]="formValue.format" name="format">
        @for (format of summarizerFormats; track format) {
        <mat-option [value]="format">{{ format }}</mat-option>
        }
      </mat-select>
    </mat-form-field>

    <mat-form-field>
      <mat-label>Length</mat-label>
      <mat-select [(ngModel)]="formValue.length" name="length">
        @for (size of summarizerSizes; track size) {
        <mat-option [value]="size">{{ size }}</mat-option>
        }
      </mat-select>
    </mat-form-field>

    <mat-form-field>
      <mat-label>Type</mat-label>
      <mat-select [(ngModel)]="formValue.type" name="type">
        @for (type of summarizerTypes; track type) {
        <mat-option [value]="type">{{ type }}</mat-option>
        }
      </mat-select>
    </mat-form-field>

    <mat-form-field>
      <mat-label>Output Language</mat-label>
      <mat-select [(ngModel)]="formValue.outputLanguage" name="outputLanguage">
        @for (lang of outputLanguages; track lang.value) {
        <mat-option [value]="lang.value">{{ lang.displayValue }}</mat-option>
        }
      </mat-select>
    </mat-form-field>

    <mat-form-field class="context-field">
      <mat-label>Context</mat-label>
      <textarea matInput [(ngModel)]="formValue.context" name="context"></textarea>
    </mat-form-field>

    <div class="form-actions">
      <button type="button" matButton="text" (click)="summarizeComments(comments)">
        Summarize
      </button>
      <button type="button" matButton="text" (click)="summarizeCommentsStream(comments)">
        Stream Summarize
      </button>
    </div>
  </form>

  <div class="summary-container">
    @if (isSummaryInProgress() && !summary()) {
    <mat-spinner diameter="36"></mat-spinner>
    } @if (summary(); as summary) {
    <article class="summary-article">
      <h3 class="summary-header">
        <span>Content summary</span>@if (isSummaryInProgress()) {
        <mat-spinner diameter="24"></mat-spinner>
        }
      </h3>
      <p>{{ summary }}</p>
    </article>
    }
  </div>

  <div class="comments-thread">
    @for (comment of comments; track comment.author) {

    <mat-card class="comment-card" appearance="outlined">
      <mat-card-header>
        <mat-card-title>{{ comment.author }}</mat-card-title>
        <mat-card-subtitle>{{ comment.date }}</mat-card-subtitle>
      </mat-card-header>
      <mat-card-content>
        <p>{{ comment.content }}</p>
      </mat-card-content>
    </mat-card>
    }
  </div>
</section>
